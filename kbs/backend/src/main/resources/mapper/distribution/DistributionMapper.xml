<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kimbap.kbs.distribution.mapper.DistributionMapper">

<select id="getInOutCheck" resultType="com.kimbap.kbs.distribution.service.DistributionVO">
  SELECT
  temp.regDt,
  temp.type,
  temp.pCode,
  temp.prodName,
  temp.qty,
  temp.wareAreaCd,
  temp.stockQty,
  temp.note
  FROM (

    SELECT 
      a.inbo_dt AS regDt,
      '입고' AS type,
      a.pcode,
      b.prod_name AS prodName,
      a.inbo_qty AS qty,
      '' AS note,
      c.ware_area_cd AS wareAreaCd ,
      c.qty AS stockQty
    FROM prod_inbo a
    JOIN product b ON a.pcode = b.pcode
    JOIN ware_stock c ON a.prod_inbo_cd = c.prod_inbo_cd

    UNION ALL

    SELECT 
      a.rel_dt AS regDt,
      '출고' AS type,
      b.pcode,
      b.prod_name AS prodName,
      a.rel_qty AS qty,
      d.note,
      e.ware_area_cd AS wareAreaCd ,
      e.qty AS stockQty
    FROM prod_rel a
    JOIN product b ON a.pcode = b.pcode
    JOIN release_ord d ON a.rel_ord_cd = d.rel_ord_cd
    JOIN prod_inbo f ON a.lot_no = f.lot_no
    JOIN ware_stock e ON f.prod_inbo_cd = e.prod_inbo_cd
  ) temp
  ORDER BY temp.regDt DESC
</select>
</mapper>


<!-- 제품명 검색 -->

<!-- 창고 검색 -->

<!-- 제품코드 검색 -->

<!-- 입출고일자 검색 -->